<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.12 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-hartke-xmpp-stupid-00" category="info">

  <front>
    <title abbrev="mptcp-timeout">Multipath TCP Idle Timeout</title>

    <author initials="K." surname="Hartke" fullname="Klaus Hartke">
      <organization>U. catholique de Louvain</organization>
      <address>
        <email>hartke@tzi.org</email>
      </address>
    </author>
    <author initials="C." surname="Bormann" fullname="Carsten Bormann">
      <organization>U. catholique de Louvain</organization>
      <address>
        <postal>
          <street>Postfach 330440</street>
          <city>Bremen</city>
          <code>D-28359</code>
          <country>Germany</country>
        </postal>
        <phone>+49-421-218-63921</phone>
        <facsimile>+49-421-218-7000</facsimile>
        <email>cabo@tzi.org</email>
      </address>
    </author>

    <date year="2009" month="July" day="05"/>

    <area>TSV</area>
    <workgroup>MPTCP Working Group</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document discusses the idle timeout of MPTCP sessions,
and defines an MPTCP Option subkind for hosts to announce and
request this value.</t>



    </abstract>


  </front>

  <middle>


<section anchor="problems" title="Introduction">

<t><xref target="I-D.ietf-mptcp-rfc6824bis"/> defines the Multipath TCP.
However, the lifetime of idle Multipath-level connections was barely discussed.</t>

<t>There are several situations in which a host want to adjust the timeout.</t>

<t><list style="hanging">
  <t hangText='use case 1:'>
  By reducing this timeout, a highly-loaded server can quickly
terminate idle MPTCP connections. It can send an MPTCP option
to signal its peers that the connections will be closed shortly.</t>
  <t hangText='use case 2:'>
  On the other hand, requesting its peer a higher value allows a host
to extend the lifetime of the connection for the desired duration.</t>
</list></t>

<section anchor="need" title="The Need for Standardization">

<t>An MPTCP-enabled host may have its own timing-out policy for idle sessions.
However, in many cases, it is necessary to exchange the idle timeout value,
which requires the standardization.</t>

<t>For regular TCP, extending the connection lifetime by increasing 
the idle timeout value is usually not enough since it is common 
that the NAT/middleboxes on the path could explicitly or silently
terminate the connection.</t>

<t>For Multipath TCP, this is a much lesser problem since the closure
of one or all subflows do not terminate the multipath-level session.</t>

</section>
<section anchor="Terminology" title="Terminology">
<t>In this document, the key words “MUST”, “MUST NOT”, “REQUIRED”,
“SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”,
and “OPTIONAL” are to be interpreted as described in BCP 14, RFC 2119 <xref target="RFC2119"/>.</t>

</section>
<section anchor="define" title="MPTCP timeout definition">

<t>There are different variances of multi-path timeout that could be exchanged.</t>

<t>One may think of MPTCP timeout as the time elapsed since the last subflow
of the connection closed, i.e. the duration that there is no subflow alive.
However, two ends of a connection may have different views about the state
of each subflow, due to TCP RST (or FIN-ACK?) packet loss. Moreover, a middlebox
such as NAT may silently drop the subflow, 
while one end or both ends think the subflow is still alive.
It is necessary to implement an additional mechanism at the subflow level, e.g.
TCP Keepalive to make sure the subflow is alive.
This means that negotiating the no-subflow timeout between two ends is not enough
to prevent the MPTCP session from timing out (use case 2) due to middleboxes.</t>

<t>The alternative way is to exchange the MPTCP idle timeout (ITO), which is defined as the duration
since the last TCP packet sent on any subflow of the MPTCP session. Relying on
this value, MPTCP hosts do not need to worry about the middlebox interference
or TCP RST (or FIN-ACK?) packet loss.</t>

</section>
</section>
<section anchor="ops" title="Basic Operation">

<t>The operation of MPTCP ITO option is similar to the TCP UTO option (defined in <xref target="RFC5482"/>).</t>

<section anchor="ito-option-and-the-local-policy" title="ITO Option and the local policy">

<t>On receiving this option, the receiver MAY choose to accept this request.
 In this case, SHOULD respond with the same value and notify the application about the new ITO.</t>

<t>Alternatively, when it does not accept the requested value based on local policy,
 it MAY choose to either respond with its own current value or it MAY ignore the request if it comes from an untrusted peer.</t>

<t>When the initiator receives the ITO option with the same value, it SHOULD apply this same value to the connection.</t>

<t>However, the exchange of MPTCP Idle Timeout Option is not a binding negotiation.
A host may have a local policy that overrides the negotiated value, for example 
when it needs to terminate long idle connection due to the increasing memory resource pressure.</t>

<t>After the idle timeout fired, the host should move the connection state
machine to close state, and report the timeout error to the user.</t>

</section>
<section anchor="ito-option-is-unreliable" title="ITO Option is Unreliable">

<t>MPTCP ITO Option does not require reliable handshaking, therefore, 
implementations MUST NOT assume that it is transferred reliably.</t>

</section>
<section anchor="format" title="Option Format">

<t>The specific format of the ITO option is depicted in Fig. <xref target="figformat"/>:</t>

<t><list style="hanging">
  <t hangText='Granularity (1 bit):'>
  Flag to indicate the time resolution.
 When set (G = 1), the time value in “Idle Timeout” field 
 MUST be interpreted as minutes. Otherwise (G = 0), the
 “Idle Timeout” field MUST be interpreted as seconds.</t>
  <t hangText='Idle Timeout (16 bits):'>
  Specifies the requested Idle Timeout for the MPTCP session.
    The granularity of this time value (minutes or seconds)
    depends on the “G” field.</t>
</list></t>

<figure title="MPTCP Idle Timeout Option Format" anchor="figformat"><artwork><![CDATA[
                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +---------------+---------------+-------+-------+---------------+
   |     Kind      |  Length = 5   |Subtype|(rsv)|G|  Idle Timeout |
   +---------------+---------------+-------+-------+---------------+
   | Idle Timeout  |
   +---------------+

]]></artwork></figure>

<t>Alternatively, Experimental Multipath TCP option could be used but 
it have a larger option size than the normal one.</t>

</section>
</section>
<section anchor="implementation-and-interoperability" title="Implementation and Interoperability">

<section anchor="middleboxes" title="Middleboxes">

</section>
<section anchor="interaction-with-keepalives" title="Interaction with Keepalives">

<t>On some MPTCP implementations like Linux, the TCP Keepalive is supported at the
MPTCP layer. To implement the idle timeout option, these implementations
may use the MPTCP KeepAliveTime value to keep track the current idle time. However,
the idle timeout mechanism, when activated, should overwrite the keepalive mechanism.
This means that after the idle timeout fired, the host should abort the connection
instead of sending the TCP keepalives.</t>

<t>MPTCP Idle Timeout Option MAY be controlled on a system-wide setting or 
on a per-connection basis. Specific APIs and mechanisms for controlling the ITO option
are out of the scope of this document.</t>

</section>
</section>
<section anchor="security-considerations" title="Security Considerations">

<t>On-path attackers may insert an MPTCP option into all observed sessions
to increase the idle timeout to a very high value so that those un-closed
sessions may accumulate on the host and exhaust the system resources.</t>

<t>On the other hand, on-path attackers may try to reduce the idle timeout to
a very low value (e.g. one second), so that any session that experiences
a short idle duration would be dropped, effectively causes a type of DoS attack.</t>

<t>To mitigate this attack, the hosts supporting this option SHOULD restrict
the valid idle timeout value in a realistic range. The hosts MAY either cap
the requested timeout value to the upper/lower threshold or just ignore it.</t>

<t>Furthermore, the hosts could limit the numbers of the long idle sessions,
and start shedding those ones with longest idle time when the system resources
are under pressure.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>




    </references>

    <references title='Informative References'>





<reference anchor="I-D.ietf-mptcp-rfc6824bis">
<front>
<title>TCP Extensions for Multipath Operation with Multiple Addresses</title>

<author initials='A' surname='Ford' fullname='Alan Ford'>
    <organization />
</author>

<author initials='C' surname='Raiciu' fullname='Costin Raiciu'>
    <organization />
</author>

<author initials='M' surname='Handley' fullname='Mark Handley'>
    <organization />
</author>

<author initials='O' surname='Bonaventure' fullname='Olivier Bonaventure'>
    <organization />
</author>

<author initials='C' surname='Paasch' fullname='Christoph Paasch'>
    <organization />
</author>

<date month='June' day='8' year='2019' />

<abstract><t>TCP/IP communication is currently restricted to a single path per connection, yet multiple paths often exist between peers.  The simultaneous use of these multiple paths for a TCP/IP session would improve resource usage within the network and, thus, improve user experience through higher throughput and improved resilience to network failure.  Multipath TCP provides the ability to simultaneously use multiple paths between peers.  This document presents a set of extensions to traditional TCP to support multipath operation.  The protocol offers the same type of service to applications as TCP (i.e., reliable bytestream), and it provides the components necessary to establish and use multiple TCP flows across potentially disjoint paths.  This document specifies v1 of Multipath TCP, obsoleting v0 as specified in RFC6824, through clarifications and modifications primarily driven by deployment experience.</t></abstract>

</front>

<seriesInfo name='Internet-Draft' value='draft-ietf-mptcp-rfc6824bis-18' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-mptcp-rfc6824bis-18.txt' />
</reference>



<reference  anchor="RFC5482" target='https://www.rfc-editor.org/info/rfc5482'>
<front>
<title>TCP User Timeout Option</title>
<author initials='L.' surname='Eggert' fullname='L. Eggert'><organization /></author>
<author initials='F.' surname='Gont' fullname='F. Gont'><organization /></author>
<date year='2009' month='March' />
<abstract><t>The TCP user timeout controls how long transmitted data may remain unacknowledged before a connection is forcefully closed.  It is a local, per-connection parameter.  This document specifies a new TCP option -- the TCP User Timeout Option -- that allows one end of a TCP connection to advertise its current user timeout value.  This information provides advice to the other end of the TCP connection to adapt its user timeout accordingly.  Increasing the user timeouts on both ends of a TCP connection allows it to survive extended periods without end-to-end connectivity.  Decreasing the user timeouts allows busy servers to explicitly notify their clients that they will maintain the connection state only for a short time without connectivity.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='RFC' value='5482'/>
<seriesInfo name='DOI' value='10.17487/RFC5482'/>
</reference>




    </references>



  </back>

<!-- ##markdown-source:
H4sIAIvUGV0AA61Za2/cuBX9zl9BeL/Y2NGs7TjZZICgdd5G7DiNnS6Koig4
EmeGtSRqScr2bOL+9p57SWmksb3tAh1gN2OJj/s499xDTpZlIphQ6pk8a8tg
GhVW8vL1Z3lSlFpemkrbNgg1nzt9PZNVE/ImC+lpYfNaVZhZOLUI2Uq5cKWz
26ppMh/axhTZ/r4oVMCIw/39F9n+z9n+U5HjwdK69UyaemGFMI2byeBaH2jQ
/qFQTquZvLz4q7ix7mrpbNvAuM9k1C94YOqlfE8PxZVeY0Qxkyd10K7WIXtD
hgjhg6qLf6rS1th6rb1ozEz+Pdh8Ir11wemFx7d1RV/+IYRqw8q6mZCZkPiY
2s/kx6n8wP7wo+jmx1K1fvjYuqWqzW8qGFvP5NephG8rW5pfWy0LLU9te61M
zUN1pUw5kzFGfw6/mSkmj3Z8PZWvrKtUXQ+2fK2cD7oevcHE/7KZh4s6zORn
68NC5Sv55Mn+0dE+v8tNQOhfOV3pODi3BTZ6kx0+f/L0RXrS1oES9F7Trmt+
2Kw4mj8evciODg+yw4Pn2bMnLw4P+CU28aYy5daAn/f394fe52pue99FTT4F
c60Refnl3evDg4MXM+ABqBi8OMneTI0Oiyxizy3yZ88Pj+bGp1lPj54fYlaW
ZVLN4bjKAYDLlfES8GzhZJCF8XnrvfYyrLQ0BOwEYWkXCVl465FFPxGADuK5
MDXGqzq9Pm8ox9K3c+CvkLBQrhBcrGgxqEbAco0vhXAa+fABO8GCa1W2eiqi
dZUpsLMQAKuzRZvzgunz7YfG2XmpK38nXg4+Qnz79mgA7u56O8mvUflOxQd7
o6+1m/C70iw0uUz+sv/94KzEqBIpr2vNJnl5o7ycowjLdR+5Ykox1Q4+4j9P
C6tSehNaFeeYWt6sDJCmOC5YA3Gn2BT/ajkafcgpHK3XwAL+d4DMAYxr6TQi
QpXNcUtDJ7SaWa7KdVZaVegCOztsjbm1/LU1+VW5Fqj8ytTglOQYp2vgzlSe
BJ7gNRLXJ9RyQgVM9GZZwxmDZDZaOwqmihaPgmLKUs7xrLSeDAFhhHI9cuaQ
nTmvea7F/4ARQGIiEybIvW6X5Bm+MEakKkt741P0yCp9G8je7eSNzWIc0qNC
e4MQyqJ1nBCyizMmP2kd4XpBnKhckeiKQVfj5R2B89GPEMcpYpmuFRBaxPxW
ag3nrjU7ZG9qShn8y6imGpBSvuZNOSVdaQ0wCbgQsXDcQMUmSGQdTmGkcmvJ
/ucI3lLfL1kO2EREuFFo4XmsAD92EUF4BxucXralclQVkxTWCLRRJPsgz9ew
LkcL8jRKPLw9mdv6Fllby9oGqcEAyxWgRDQQvcltVWFd0aPp0/HlT5ED5vYW
FtsIFK5YMG5ZwLgGkUMzXoPjsVgJ8hohfGxz8m9U95NYQIagVLUIUImQAmWJ
XpKFvA6A3DotACoQO20Ib4jgFozEwrJj472rLdZImSW0XfJAW9rlWsoNrQ0e
j4AGFoyWdiQdeQodXVJL93Ln7OvF5c4k/is/nfP3L2//8vXky9s3OxOxc/Hh
+PSUHvKXbsTFh/Ovp2823zYzX5+fnb399OYtvzw7/ttOZPqd88+XJ+efjk93
mNqAPBS5IT3ROB0Ad5Ahqit3Zo4/gNtXII+Dowm1HkkdS377lnrX3R2XXeSX
Di7M0KavuEjYj9fckGYLs1jge02Yc0YhcZ4ogJOQccK7TRhjEUOwvisdIu1z
pJZqFbGurzbdrpuofE/NUpeqYWrrIVIqVHpChLhPPpEKUb1TPY0slNinZ1DH
hVLbbhFADF192JtuUOl1wX6p4do9vwyCYDQx5Dw6zNUeGL6aFE7aYQIjOIvk
5RcgZxfAfnfyKTt+/fFPeyi2/EoHCcPRF86s05bNULIvTOGpahAXlCtb0ZUh
RK5t4sbdVsRBYAYqH+Jq7DQH7UeHYsAHwykS6AGosRSEk/ukZ6qm1CxZ0KdU
UTBu0JsqTRk1vpKJS7o1uQzBatPlVJDHH7VueHlarVJXNNLpbTOSASySKq3q
1PJqyPJgVOjYsbZZN6nDy1yHGw052ueN09vxH/UtVM01OcCKZKis5MLZKrUJ
SWvtbhrnXpe1AT9OUwNTJWl7loNQFWvacbs9xH1GLL17cnm+N0mahGiG667o
AN8hVWyBndZJGPHkBcymNtWFIdXAyK+p/AKlxE5BTvSqb5JGRZWY2JT6LVkP
ikPCN1Du3Y7Mw4DPgW33P8BYiFdoVTkUqnabzm6bLSU5VpUUWNtP6GkBQUvC
iNFKih6NEwaTkTTg62bAbhdScCJTIAnxu7s9yhutkxSz6kSMzQHkKA1+V3Ew
CUJEORSGue4lYdw1don4Cl0NNC7zlQUNsdbMc90k5Z0k11TIrtEQ0iYydQUo
hsbCshtDLErVgdNWJ8XwHMkyizW/UQ015RioTcZqfUPRgrPHG3yWa0IcygMK
oLA6lkZvle6MQsziTnNFfEviYxCciaDpY8+0YTU5sroTXnnrUo+gJUlzxdlQ
tTaVfncmMQt6CWEC07gawTJ00mvZJpKl8OcXcoBVD7UtFVhBcbxj6Qww8kD0
WMulIFPk1jH4g/AmNI1kzPiw0tf2BpeDu4gOWIl5lJybKOh6+qIlj7dkqhrF
OPIdcb8zRfKrm95lZ8ICVt8q4mSi+phXKmFmoI0yKi0JezJx0MCKjasDOVnp
yjo67XjbOhAP2NITQ1MMjhdY8r7cXZCwj4Fhl3DyoD5f2ettPZg6YoV2iMKk
3blDx8cTxrXTDc4tw+OYRAxsX+OgZLdVwIjz1xqHQUPq//HK7XTPYGZfAkmk
y24VPhb5laKrnEnUCYg1TBR9A0zHyk78gbc9ZGLMW9TXOOnXHkxJx560MB/H
0ubv+A6hk6HxRmFbdkUe9I3OzQIMGgd1JD/mwkI3Jg+R7d6Z5RSUtzDLtOwd
Dn7vYQ4dM0xYy90DgDLszXAalO9KteTWDpDmnY5mvUUgKNsIV7KSC8+D1nff
y5fyYG+yGZrOHLXcGVbCDrChAQWezZG6L10B0TagmcpzCvONARx4+f24PE99
cNFH1vMaeCuo64xqcvfgGbns9+hSBl5fxJim0trw3mhSd3gdt1M2ifKyHESU
c5IuBlI0dpNrfFSKVu3xXKQqSspIYzvvk0uw+d/9R8hHPgcPPDt84NkTXmEf
4w/lE3kkn8pn8mf5XL74I89ojR+3Cumxv7f/7d/TIt/Zpo90NcUf/H2q6yXo
+SV2xN8X7TysG/191/nrve/v8X6Uiu//R0tGCz+y8igV32byh76YJF9Gv9x5
nPhjZe/ciXu99+0tJI1h+ii3brNTJfdnpJY67xyLCrBJ1yGUW4KB01BvfmO+
qZMWxqYlSX2C/oilmFj5BpoV1dyUQOyj2mskw842cnd0OBa8nMo3XbYX9v73
xBMLJ4/+3kniLTotDU4Ep6ib20kv6TZHBurTbUMNgmqdu0Qi9VKt0Rfk5fCE
cv8qdaPQwDJbWwvqxCT4NwVPGx/TxpdmKA6u8JjIPY+np07e9FtNZScW7t/N
9OekpMMogtfU0idd26SefwNK0em6ofO9n3n/WKT+UF+GRHTbt4fC1GA/VRCN
+cH1E0WhN4E49XHQk6Kb85rB2bKMslFJv8bCVXYDFUOtg49u4EPBL4HGbKAO
oDYNGsFF1+6OP594xm7vu2dK7vborNw0QvplRqZbc5Z9ORDfc3N3kwM/LjTS
Rrz9GqmHbS6B4NFCOK/jhYYKgY42zrNyQ9i0C9t3ttSSLF9W2TnfBxf9DaPg
Rstq64GLQ5olkf81X70mxHnb3VaQVGrrLN5qiG5JNgQavq3Qi4LuugqnnIKn
b1equ+GO2ejVnef7l3u3wfZBX0O8AeB78AdtF8l2OoemDkjHfr59iP1vb9J7
w4fWdO7mB5qpkU6VHgvx7XXcoL+zuemoke45GoK2XiwIOsStOD219PuJktRF
KOVv7EXygH4aoJN7MMuob+iGgd9sqqNnlq3z3OA8FhwEFpc0vDPFg5euhGok
tzQ+AMCODglT1gpxDyqSdFTKVSPG0mO8VKd34an7CSHlCocVK1vyRQ7/apGO
UIYg/a51tHDFOnXjVmwoJU7K6VzYVnNKaaqQzdFg/PsSJLkjytBFIgMCn6Vf
cpjtaRof2LoYRDp7CGNck21d8B1vf5hAL0C951fiP2EZ7fTfHQAA

-->

</rfc>

